<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>X√°c nh·∫≠n ƒë∆°n h√†ng - Pet Store</title>
    <link rel="stylesheet" href="webThuCung.css" />
    <link rel="stylesheet" href="product.css" />
    <link rel="stylesheet" href="orderConfirmationPage.css" />
  </head>
  <body>
    <header class="header-1">
      <div class="logo">
        <a href="webThuCung.html">
          <img src="images/logo.avif" alt="logo" />
        </a>
      </div>
      <form action="#" method="get" class="search-form" id="search-form">
        <input
          type="text"
          name="search"
          placeholder="Search pets..."
          id="search-input"
        />
        <button class="button" type="submit">Search</button>
      </form>
      <nav class="nav">
        <ul class="nav-list">
          <li><a href="webThuCung.html">Home</a></li>
          <li><a href="product.html">Product</a></li>
          <li><a href="#con">Contact</a></li>
          <li id="auth-links" class="fasUsers">
            <a href="login.html" id="login-link">Login</a>
            <a href="register.html" id="register-link">Register</a>
          </li>
          <li id="account-link" style="display: none">
            <a href="account.html">My Account</a>
            <a href="#" id="logout-link">Logout</a>
          </li>
          <li>
            <a href="cart.html" id="cart-link"
              >Cart(<span id="cart-count">0</span>)</a
            >
          </li>
        </ul>
      </nav>
    </header>

    <main class="confirmation-page">
      <div class="confirmation-wrapper">
        <!-- Success Animation -->
        <div class="success-animation">
          <div class="success-circle">
            <div class="checkmark-icon">‚úì</div>
          </div>
          <div class="success-rings">
            <div class="ring ring-1"></div>
            <div class="ring ring-2"></div>
            <div class="ring ring-3"></div>
          </div>
        </div>

        <!-- Main Content -->
        <div class="confirmation-content">
          <h1 class="confirmation-title">ƒê·∫∑t h√†ng th√†nh c√¥ng!</h1>
          <p class="confirmation-subtitle">
            C·∫£m ∆°n b·∫°n ƒë√£ mua h√†ng t·∫°i Pet Store. ƒê∆°n h√†ng c·ªßa b·∫°n ƒë√£ ƒë∆∞·ª£c x√°c
            nh·∫≠n v√† s·∫Ω ƒë∆∞·ª£c x·ª≠ l√Ω trong th·ªùi gian s·ªõm nh·∫•t.
          </p>

          <!-- Order Summary Card -->
          <div class="order-summary-card" id="orderSummary">
            <div class="card-header">
              <h2>Th√¥ng tin ƒë∆°n h√†ng</h2>
              <span class="order-badge" id="orderStatus">Ch·ªù x·ª≠ l√Ω</span>
            </div>
            <div class="card-body">
              <div class="order-info-grid">
                <div class="info-item">
                  <span class="info-label">M√£ ƒë∆°n h√†ng</span>
                  <span class="info-value order-id" id="orderId">#000000</span>
                </div>
                <div class="info-item">
                  <span class="info-label">Ng√†y ƒë·∫∑t h√†ng</span>
                  <span class="info-value" id="orderDate">--/--/----</span>
                </div>
                <div class="info-item">
                  <span class="info-label">Ph∆∞∆°ng th·ª©c thanh to√°n</span>
                  <span class="info-value" id="paymentMethod">--</span>
                </div>
                <div class="info-item">
                  <span class="info-label">T·ªïng ti·ªÅn</span>
                  <span class="info-value total-price" id="orderTotal">$0.00</span>
                </div>
              </div>
            </div>
          </div>

          <!-- Shipping Info Card -->
          <div class="shipping-card" id="shippingInfo">
            <h3 class="card-title">
              <span class="title-icon">üìç</span>
              Th√¥ng tin giao h√†ng
            </h3>
            <div class="shipping-details" id="shippingDetails">
              <!-- Shipping details will be loaded here -->
            </div>
          </div>

          <!-- Order Items Card -->
          <div class="items-card" id="orderItems">
            <h3 class="card-title">
              <span class="title-icon">üì¶</span>
              S·∫£n ph·∫©m ƒë√£ ƒë·∫∑t
            </h3>
            <div class="items-list" id="itemsList">
              <!-- Items will be loaded here -->
            </div>
          </div>

          <!-- Action Buttons -->
          <div class="action-buttons">
            <a href="product.html" class="btn btn-primary">
              <span class="btn-icon">üõí</span>
              Ti·∫øp t·ª•c mua s·∫Øm
            </a>
            <a href="account.html" class="btn btn-secondary">
              <span class="btn-icon">üìã</span>
              Xem ƒë∆°n h√†ng c·ªßa t√¥i
            </a>
            <button class="btn btn-outline" id="printOrderBtn">
              <span class="btn-icon">üñ®Ô∏è</span>
              In ƒë∆°n h√†ng
            </button>
          </div>

          <!-- Contact Support -->
          <div class="support-card">
            <h3 class="support-title">C·∫ßn h·ªó tr·ª£?</h3>
            <p class="support-text">
              N·∫øu b·∫°n c√≥ b·∫•t k·ª≥ c√¢u h·ªèi n√†o v·ªÅ ƒë∆°n h√†ng, vui l√≤ng li√™n h·ªá v·ªõi
              ch√∫ng t√¥i
            </p>
            <div class="support-contacts">
              <div class="contact-item">
                <span class="contact-icon">üìû</span>
                <div class="contact-info">
                  <span class="contact-label">Hotline</span>
                  <span class="contact-value">0123-456-789</span>
                </div>
              </div>
              <div class="contact-item">
                <span class="contact-icon">üìß</span>
                <div class="contact-info">
                  <span class="contact-label">Email</span>
                  <span class="contact-value">support@petstore.com</span>
                </div>
              </div>
              <div class="contact-item">
                <span class="contact-icon">üïí</span>
                <div class="contact-info">
                  <span class="contact-label">Gi·ªù l√†m vi·ªác</span>
                  <span class="contact-value">8:00 - 22:00 (T2 - CN)</span>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </main>

    <script type="module">
      import confetti from "https://cdn.skypack.dev/canvas-confetti";

      // Authentication state management
      function updateAuthState() {
        const currentUser = JSON.parse(localStorage.getItem("currentUser"));
        const authLinks = document.getElementById("auth-links");
        const accountLink = document.getElementById("account-link");
        const logoutLink = document.getElementById("logout-link");

        if (currentUser) {
          authLinks.style.display = "none";
          accountLink.style.display = "block";
          accountLink.querySelector(
            "a"
          ).textContent = `Hi, ${currentUser.userName}`;
        } else {
          authLinks.style.display = "block";
          accountLink.style.display = "none";
        }

        // Logout functionality
        logoutLink?.addEventListener("click", (e) => {
          e.preventDefault();
          localStorage.removeItem("currentUser");
          localStorage.removeItem("cart");
          window.location.href = "webThuCung.html";
        });
      }

      // Cart count update
      function updateCartCount() {
        const cart = JSON.parse(localStorage.getItem("cart")) || [];
        const total = cart.reduce((sum, item) => sum + item.quantity, 0);
        const countEl = document.getElementById("cart-count");
        if (countEl) countEl.textContent = total;
      }

      // Get status text
      function getStatusText(status) {
        const statusMap = {
          pending: "Ch·ªù x·ª≠ l√Ω",
          processing: "ƒêang x·ª≠ l√Ω",
          shipped: "ƒê√£ g·ª≠i h√†ng",
          delivered: "ƒê√£ giao h√†ng",
          cancelled: "ƒê√£ h·ªßy",
        };
        return statusMap[status] || status;
      }

      // Get status class
      function getStatusClass(status) {
        const classMap = {
          pending: "status-pending",
          processing: "status-processing",
          shipped: "status-shipped",
          delivered: "status-delivered",
          cancelled: "status-cancelled",
        };
        return classMap[status] || "status-pending";
      }

      // Get payment method text
      function getPaymentMethodText(method) {
        const methodMap = {
          creditCard: "Th·∫ª t√≠n d·ª•ng",
          bankTransfer: "Chuy·ªÉn kho·∫£n ng√¢n h√†ng",
          cod: "Thanh to√°n khi nh·∫≠n h√†ng",
          momo: "V√≠ ƒëi·ªán t·ª≠ MoMo",
        };
        return methodMap[method] || method;
      }

      // Load order details
      function loadOrderDetails() {
        const urlParams = new URLSearchParams(window.location.search);
        const orderId = urlParams.get("orderId");

        if (!orderId) {
          alert("Kh√¥ng t√¨m th·∫•y th√¥ng tin ƒë∆°n h√†ng!");
          window.location.href = "webThuCung.html";
          return;
        }

        const orders = JSON.parse(localStorage.getItem("orders")) || [];
        const order = orders.find((o) => o.id == orderId);

        if (!order) {
          alert("Kh√¥ng t√¨m th·∫•y ƒë∆°n h√†ng!");
          window.location.href = "webThuCung.html";
          return;
        }

        // Update order summary
        document.getElementById("orderId").textContent = `#${order.id}`;
        document.getElementById("orderDate").textContent = new Date(
          order.date
        ).toLocaleDateString("vi-VN", {
          year: "numeric",
          month: "long",
          day: "numeric",
        });
        document.getElementById("orderTotal").textContent = `$${order.total.toFixed(
          2
        )}`;
        document.getElementById("orderStatus").textContent = getStatusText(
          order.status
        );
        document.getElementById("orderStatus").className = `order-badge ${getStatusClass(
          order.status
        )}`;

        const paymentMethod = order.paymentMethod || "cod";
        document.getElementById("paymentMethod").textContent =
          getPaymentMethodText(paymentMethod);

        // Update shipping info
        const shippingDetails = document.getElementById("shippingDetails");
        if (order.customer) {
          shippingDetails.innerHTML = `
            <div class="detail-row">
              <span class="detail-label">H·ªç v√† t√™n:</span>
              <span class="detail-value">${order.customer.firstName || ""} ${
            order.customer.lastName || ""
          }</span>
            </div>
            <div class="detail-row">
              <span class="detail-label">Email:</span>
              <span class="detail-value">${order.customer.email || ""}</span>
            </div>
            <div class="detail-row">
              <span class="detail-label">S·ªë ƒëi·ªán tho·∫°i:</span>
              <span class="detail-value">${order.customer.phone || ""}</span>
            </div>
            <div class="detail-row">
              <span class="detail-label">ƒê·ªãa ch·ªâ:</span>
              <span class="detail-value">${order.customer.address || ""}, ${
            order.customer.city || ""
          } ${order.customer.zipCode || ""}</span>
            </div>
          `;
        }

        // Update order items
        const itemsList = document.getElementById("itemsList");
        if (order.items && order.items.length > 0) {
          itemsList.innerHTML = order.items
            .map(
              (item) => `
              <div class="item-card">
                <div class="item-image-wrapper">
                  <img src="${item.image}" alt="${item.name}" class="item-image" />
                </div>
                <div class="item-details">
                  <h4 class="item-name">${item.name}</h4>
                  <p class="item-breed">Gi·ªëng: ${item.breed || "N/A"}</p>
                  <p class="item-quantity">S·ªë l∆∞·ª£ng: ${item.quantity}</p>
                </div>
                <div class="item-price-wrapper">
                  <span class="item-price">$${(
                    item.price * item.quantity
                  ).toFixed(2)}</span>
                  <span class="item-unit-price">$${item.price.toFixed(
                    2
                  )} / s·∫£n ph·∫©m</span>
                </div>
              </div>
            `
            )
            .join("");
        }

        // Trigger confetti effect
        setTimeout(() => {
          confetti({
            particleCount: 150,
            spread: 80,
            origin: { y: 0.6 },
          });
        }, 300);
      }

      // Print order
      document.getElementById("printOrderBtn")?.addEventListener("click", () => {
        window.print();
      });

      // Initialize
      updateAuthState();
      updateCartCount();
      loadOrderDetails();
    </script>
  </body>
</html>


